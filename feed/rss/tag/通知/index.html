<?xml version="1.0" encoding="UTF-8"?>
<rdf:RDF
xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
xmlns="http://purl.org/rss/1.0/"
xmlns:dc="http://purl.org/dc/elements/1.1/">
<channel rdf:about="https://limbopro.xyz/feed/rss/tag/%E9%80%9A%E7%9F%A5/">
<title>毒奶博主丨欢迎使用代理访问本站。 - 通知</title>
<link>https://limbopro.xyz/tag/通知/</link>
<description></description>
<items>
<rdf:Seq>
<rdf:li resource="https://limbopro.xyz/archives/tgbotalert.html"/>
<rdf:li resource="https://limbopro.xyz/archives/1888.html"/>
</rdf:Seq>
</items>
</channel>
<item rdf:about="https://limbopro.xyz/archives/tgbotalert.html">
<title>电报机器人报警通知丨服务器CPU监测</title>
<link>https://limbopro.xyz/archives/tgbotalert.html</link>
<dc:date>2019-12-21T19:54:00+08:00</dc:date>
<description>本文隶属于 实用工具 /网站优化 分类，点击分类名称可以查看更多相关文章；[post cid="1959" cover="https://limbopro.xyz/usr/uploads/2019/11/3967700330.png"/][post cid="1888" cover="https://limbopro.xyz/usr/uploads/2019/08/1077784791.png"/]主理人说1.拿来即可用的 Telegram Bot Api（免费）（API是什么？）；2.如果你也有博客或需要监测服务器性能；3.这或许是个好办法；4.当服务器CPU触到阈值，则触发警报；5.真的不要太好用。*本文末尾提供了网站联通状态检查脚本；本文概要1.创建TG机器人并获取[API Token]；2.给机器人发送消息，并获取你电报账号的[chatID]；3.配置CPU监测及报警通知脚本；4.使用crontab设置定时任务；CPU负载检测脚本##CPU负载计算
function GetSysCPU 
 {
   CpuIdle=`vmstat 1 5 |sed -n '3,$p' | awk '{x = x + $15} END {print x/5}' | awk -F. '{print $1}'` 
   CpuNum=`echo &quot;100-$CpuIdle&quot; | bc` 
   echo $CpuNum 
 }
   cpucheck=`GetSysCPU` #将结果输出赋值到cpucheck*暂忘脚本出处简易报警脚本配合Telegram Bot Api 食用，效果佳。##CPU负载计算
function GetSysCPU 
{
CpuIdle=`vmstat 1 5 |sed -n '3,$p' | awk '{x = x + $15} END {print x/5}' | awk -F. '{print $1}'` 
CpuNum=`echo &quot;100-$CpuIdle&quot; | bc` 
echo $CpuNum 
}

cpucheck=`GetSysCPU` #将结果输出赋值到cpucheck
cpumax=50 #CPU触警阈值

if [ ${cpucheck} -gt $max ]; #阈值与实际CPU值进行对比
then
date=$(env LANG=en_US.UTF-8 date &quot;+%e/%b/%Y/%R&quot;) #当前时间赋值
curl -X POST &quot;https://api.telegram.org/bot[API Token]/sendMessage?chat_id=[chatID]&amp;text=$date%0aCPU负载为$cpucheck%%0a注意及时检查%0a如果该警报持续...%0a或联系管理员%0a@limboprobot&quot;
else
date=$(env LANG=en_US.UTF-8 date &quot;+%e/%b/%Y/%R&quot;)
echo &quot;${date}&quot; &quot;CPU负载正常，当前负载为$cpucheck%...&quot; &gt;&gt; /home/cpucheck.log #监测坚果输出到本地以便后期查阅..
fi
以上。实操部分第一步 创建机器人[post cid="3097" cover="https://limbopro.xyz/usr/uploads/2019/09/53339647.png"/]*看创建机器人部分即可，仅需三步即可创建一个新机器人；第二步 获取API Token同上，创建完机器人即可获得API Token第二步 获取chatID1.官方提供了接口2.通过第二步我们已经获得了API Token2.将下方API Token替换成自己的API Token；https://api.telegram.org/bot[API Token]/getUpdates #将[API Token]替换成自己的API token，实例说明https://api.telegram.org/bot10440392893:AQMZqM-FX_SGVVMtUj98xXWWqWCO2IbGHSw/getUpdates3.替换成自己的[API token]后，在浏览器中打开链接，提示{&quot;ok&quot;:true,...；4.给机器人发送任意英文字符，例如Hello word; 5.刷新刚刚在浏览器打开的链接，并找到Hello word；举例说明，发送Hello word后刷新链接得到；&quot;message&quot;:{&quot;message_id&quot;:1426,&quot;from&quot;:{&quot;id&quot;:763456868,&quot;is_bot&quot;:false,&quot;first_name&quot;:&quot;\u2708\ufe0f TG \u6bd2\u5976\u535a\u4e3b \u2708\ufe0f&quot;,&quot;last_name&quot;:&quot;\u4e3b\u7406\u4eba Julia \ud83c\udd65&quot;,&quot;username&quot;:&quot;limbopro&quot;,&quot;language_code&quot;:&quot;zh-hans&quot;},
&quot;chat&quot;:{&quot;id&quot;:763456868,&quot;first_name&quot;:&quot;\u2708\ufe0f TG \u6bd2\u5976\u535a\u4e3b \u2708\ufe0f&quot;,&quot;last_name&quot;:&quot;\u4e3b\u7406\u4eba Julia \ud83c\udd65&quot;,&quot;username&quot;:&quot;limbopro&quot;,&quot;type&quot;:&quot;private&quot;},&quot;date&quot;:1576931731,&quot;text&quot;:&quot;Hello word&quot;}}]}其中，"chat":{"id":763456868 里的763456868，我的Chat id；若需获取群组的Chat ID，需把机器人添加至群组，在群组内发送/hello word @xxx_bot（@xxx_bot为你的机器人） 即可；第三步 机器人发送消息1.通过上面两步，我们有了机器人以及[API Token] 以及收件人的[ChatID]；https://api.telegram.org/bot[API Token]/sendMessage?chat_id=[chatID]&amp;text=hello word1.这个是TG bot sendMessage API，简单却实用；2.你可以替换自己的[API]与[chatID]；3.正确替换后，在浏览器中打开，你将收到一条消息；4.&text=后面接你需要发的信息；5.换行用%0a表示；1
2
3则需表示成 &text=1%0a2%0a3以上。第四步 设置定时执行脚本任务1.Crontab的使用可参考Linux crontab 命令；root@localhost:/home#  crontab -e
* * * * * /home/checkcpu.sh #每分钟执行一次检测其他获取网站状态脚本命令curl -I -m 10 -o /dev/null -s -w %{http_code} https://limbopro.xyz附注1.Telegram Bot API - Telegram APIs #官方2.Bot Code Examples - Telegram APIs #官方样例3.https://github.com/python-telegram-bot/python-telegram-bot （拿来即用4.https://github.com/tg-bot-api/bot-api-base联系主理人1.关注频道 https://t.me/limboprossr 不失联；2.毒奶粉们（我管我的Fans）可联系 TG机器人 或发送 邮件 获取帮助；3.或点击本页面右下角的聊天按钮联系；</description>
</item>
<item rdf:about="https://limbopro.xyz/archives/1888.html">
<title>Monit - 配置网站服务器崩溃邮件警报</title>
<link>https://limbopro.xyz/archives/1888.html</link>
<dc:date>2019-08-07T00:02:00+08:00</dc:date>
<description>本文隶属于 实用工具 /网站优化 分类，点击分类名称可以查看更多相关文章；[post cid="6538" cover="https://limbopro.xyz/usr/uploads/2019/12/2912835083.jpg"/]Monit 总体介绍Monit是一款功能非常丰富的进程、文件、目录和设备的监测软件，适用于Linux/Unix平台。 它可以自动修复那些已经停止运作的程序,特使适合处理那些由于多种原因导致的软件错误，同时Monit 包含一个内嵌的 HTTP(S) Web 界面，你可以使用浏览器方便地查看 Monit 所监视的服务器。[...]</description>
</item>
</rdf:RDF>